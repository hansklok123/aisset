<!DOCTYPE html>
<html lang="nl">
<head>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <meta charset="utf-8"/>
  <title>ETD Overzicht</title>
  <style>
    body { 
      font-family: sans-serif; 
      max-width: 1400px;
      margin: auto; 
      padding: 1rem; 
    }
    h2 { color: #003b5c; }
    .form-header img,
    .logo {
      max-height: 100px;
      margin-bottom: 0.2rem;
      display: block;
      margin-left: auto;
      margin-right: auto;
      width: auto;
    }
    table { 
      width: 100%;
      border-collapse: collapse; 
      margin-top: 1rem; 
      table-layout: fixed;
    }
    th, td { 
      padding: 0.75rem 1rem; 
      border: 1px solid #ccc; 
      font-size: 1rem;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    /* Kolombreedtes aanpassen voor leesbaarheid, inclusief Status */
    th:nth-child(1), td:nth-child(1) { width: 150px; }
    th:nth-child(2), td:nth-child(2) { width: 100px; }
    th:nth-child(3), td:nth-child(3) { width: 60px; }
    th:nth-child(4), td:nth-child(4) { width: 170px; }
    th:nth-child(5), td:nth-child(5) { width: 120px; }
    th:nth-child(6), td:nth-child(6) { width: 150px; }
    th:nth-child(7), td:nth-child(7) { width: 120px; }
    th:nth-child(8), td:nth-child(8) { width: 90px; }  /* Status */
    th:nth-child(9), td:nth-child(9) { width: 80px; }
    th:nth-child(10), td:nth-child(10) { width: 80px; }

    th { 
      background-color: #003b5c; 
      color: white; 
      position: sticky; 
      top: 0; 
      z-index: 1;
    }
    tr:nth-child(even) { background-color: #f2f2f2; }
    button { 
      margin-top: 1rem; 
      padding: 0.5rem 1rem; 
    }
    body {
      background: url('https://keystoneacademic-res.cloudinary.com/image/upload/f_auto/q_auto/g_auto/w_724/dpr_2.0/element/11/119872_rotterdam-4152380_1920.jpg') no-repeat center center fixed;
      background-size: cover;
      animation: achtergrondFade 20s ease-in-out infinite alternate;
    }
    h2 { color: white; text-align: center; }
    table {
      width: 100%;
      border-collapse: collapse; 
      margin-top: 1rem; 
      table-layout: fixed;
      background-color: rgba(255,255,255,0.95);
      color: #000;
      font-size: 0.95rem;
      border-radius: 0.5rem;
      border: 1px solid #ccc;
    }
    th[onclick]:hover {
      background-color: rgba(0, 59, 92, 0.1);
    }
    .dashboard-box {
      background-color: rgba(0, 0, 0, 0.50);
      box-shadow: 0 0 18px rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      padding: 2rem;
      border-radius: 1rem;
      max-width: 1350px;
      margin: 2rem auto;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    }
    #zoek {
      padding: 0.5rem;
      width: 350px;
      border-radius: 1rem;
      border: 1px solid #ccc;
      box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.2);
    }
    /* Alleen scrollen op mobiel of smal scherm */
    .table-scroll {
      width: 100%;
    }
    @media (max-width: 900px) {
      .table-scroll {
        overflow-x: auto;
      }
      table {
        min-width: 1000px;
      }
    }
    @media (max-width: 1100px) {
      body { max-width: 100vw; }
      .dashboard-box { max-width: 98vw; }
      table { font-size: 0.95rem; }
      th, td { font-size: 0.93rem; }
    }
    @media (max-width: 800px) {
      th, td { font-size: 0.9rem; padding: 0.5rem 0.3rem; }
      #zoek { width: 95%; }
    }
  </style>
</head>
<body>
<img alt="logo" class="logo" src="https://hansklok123.github.io/aisset/logo.png"/>
<script>
let origineleData = [];

async function laad() {
  const res = await fetch("/data/submissions.json");
  const data = await res.json();
  origineleData = data;
  toonData(data);
}

function toonData(data) {
  const tbody = document.querySelector("tbody");
  tbody.innerHTML = "";
  data.forEach(r => {
    const rij = document.createElement("tr");
    rij.innerHTML = `
      <td>${r.Scheepsnaam || ""}${r.ScheepsnaamHandmatig || ""}</td>
      <td>${r.Type_naam || ""}</td>
      <td>${r.Lengte || ""}</td>
      <td>${r.ETD || ""}</td>
      <td>${r.RedenGeenETD || ""}</td>
      <td>${r.Toelichting || ""}</td>
      <td>${r.Timestamp || ""}</td>
      <td>${r.Status || ""}</td>
      <td>${r.Latitude || ""}</td>
      <td>${r.Longitude || ""}</td>
    `;
    tbody.appendChild(rij);
  });
}

function sorteerOp(veld) {
  const gesorteerd = [...origineleData].sort((a, b) => {
    if (!a[veld]) return 1;
    if (!b[veld]) return -1;
    return a[veld].localeCompare(b[veld]);
  });
  toonData(gesorteerd);
}

function filterOpZoekterm() {
  const zoekterm = document.getElementById("zoek").value.toLowerCase();
  const gefilterd = origineleData.filter(r =>
    r.Scheepsnaam?.toLowerCase().includes(zoek
